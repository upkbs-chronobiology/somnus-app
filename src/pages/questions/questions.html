<ion-header>
  <ion-navbar>
    <ion-title>Questions</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-slides #slides pager *ngIf="questions && questions.length > 0">
    <ion-slide *ngFor="let question of questions; let i = index">
      <h2>{{question.content}}</h2>
      <ion-item *ngIf="question.answerType !== AnswerType.MultipleChoice">
        <ion-input *ngIf="question.answerType === AnswerType.Text"
          [(ngModel)]="answers[i].content" required placeholder="..."></ion-input>
        <continuous-range item-content *ngIf="question.answerType === AnswerType.RangeContinuous"
          [(ngModel)]="answers[i].content" [min]="question.answerRange.min" [max]="question.answerRange.max" required>
          <ion-label range-left>
            {{question.answerLabels ? question.answerLabels[0] : question.answerRange.min}}
          </ion-label>
          <ion-label range-right>
            {{question.answerLabels ? question.answerLabels[1] : question.answerRange.max}}
          </ion-label>
        </continuous-range>
        <ion-range *ngIf="question.answerType === AnswerType.RangeDiscrete"
          [min]="question.answerRange.min" [max]="question.answerRange.max" step="1" snaps="true" pin="true"
          [(ngModel)]="answers[i].content" required>
          <ion-label range-left>{{question.answerLabels ? question.answerLabels[0] : question.answerRange.min}}</ion-label>
          <!-- XXX: What about intermediate labels? -->
          <ion-label range-right>
            {{question.answerLabels ? question.answerLabels[question.answerLabels.length - 1] : question.answerRange.max}}
          </ion-label>
        </ion-range>
      </ion-item>
      <ion-list radio-group *ngIf="question.answerType === AnswerType.MultipleChoice"
        [(ngModel)]="answers[i].content">
        <ion-item *ngFor="let option of question.answerLabels; let i = index">
          <ion-label>{{option}}</ion-label>
          <ion-radio [value]="i"></ion-radio>
        </ion-item>
      </ion-list>

      <ion-fab bottom right>
        <button ion-fab (click)="slides.slideNext()" [disabled]="!isValidAnswer(answers[i].content)">
          <ion-icon name="arrow-forward"></ion-icon>
        </button>
      </ion-fab>
    </ion-slide>

    <ion-slide>
      <p *ngIf="everthingAnswered()">Thanks, answers are ready to be submitted:</p>
      <p *ngIf="!everthingAnswered()">There are unanswered questions, please go back and edit.</p>
      <button *ngIf="!submitting" ion-button (click)="submitAnswers()" [disabled]="!everthingAnswered()">Submit</button>
      <ion-spinner *ngIf="submitting" color="primary"></ion-spinner>
    </ion-slide>
  </ion-slides>

  <centrizer *ngIf="questions && questions.length === 0" class="no-questions" padding>
    <ion-icon class="icon" name="checkmark"></ion-icon>
    <div>There are no questions at the moment.</div>
  </centrizer>

  <centrizer *ngIf="!questions">
    <ion-spinner></ion-spinner>
  </centrizer>
</ion-content>
